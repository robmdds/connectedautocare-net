
# Build-Out Sheet (Replit)

## Goal
Build a full-service TPA platform (auto/RV/marine/powersports/home) with:
- Rating via spreadsheets + external APIs
- VIN decode with manual entry
- D2C + reseller portals, white-label microsites and widgets
- Tax calc by purchaser location
- Checkout with **Helcim** payments only
- Contract doc gen + e-sign (DocuSign/Adobe Sign adapters)
- Claims (FNOL→decision→payout), adjuster workflows
- Analytics/KPIs + AI assistant (RAG over disclosures/FAQ)
- Multi-tenant, multi-language/currency

## Replit Run
- **Run command:** installs deps and starts both apps via `concurrently`.
- **Web:** http://localhost:3000
- **API:** http://localhost:4000 (health at `/health`)

## Env (.env)
- `NODE_ENV=development`
- `NEXT_PUBLIC_API_URL=http://localhost:4000`
- `PAYMENTS_PROVIDER=helcim`
- `HELCIM_API_BASE=https://api.helcim.com`
- `HELCIM_API_TOKEN=...`
- `HELCIM_ACCOUNT_ID=...`
- `HELCIM_WEBHOOK_SECRET=...`

## Minimal Steps for AI (Replit or Softgen)
1. **Generate Prisma schema & migrations** for products, rate tables, quotes/offers, policies, claims, payments, webhooks, events.
2. **Implement rating-engine**: spreadsheet import/validation + rules; adapters interface for external rating.
3. **Wire Helcim**: real API calls for charge/intents + webhook signature verify; on success → policy issuance + doc gen.
4. **Portals**: consumer (policies, renewals, claims), reseller (microsites, widgets, links), admin (rates/rules/disclosures/users/webhooks/analytics).
5. **AI assistant** with RAG over KB; disclosures must be grounded and tracked.
6. **Analytics events** across funnels; PostHog optional.

## Acceptance Checks
- Upload rate table → valid + active by effective dates.
- VIN fallback + manual override persists.
- Helcim webhook triggers policy issuance; receipt stored.
- D2C flow: quote → checkout → e-sign (stub) → documents visible in portal.
- Reseller microsite + embeddable widget usable.
- Claims path from FNOL to decision; audit trail present.
